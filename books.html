<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Book Management</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container mt-5">
  <h2 class="text-center mb-4">Book Management</h2>

  <!-- Form -->
  <div class="card p-3 mb-3">
    <div class="row g-3">
      <div class="col-md-4">
        <input type="text" id="productName" class="form-control" placeholder="Product Name">
      </div>
      <div class="col-md-4">
        <input type="number" id="price" class="form-control" placeholder="Price">
      </div>
      <div class="col-md-4">
        <input type="number" id="quantity" class="form-control" placeholder="Quantity">
      </div>
      <div class="col-md-12">
        <button type="button" class="btn btn-primary w-100" onclick="addProduct()">Save Product</button>
      </div>
    </div>
  </div>

  <!-- Table -->
  <table class="table table-bordered table-striped">
    <thead class="table-white">
      <tr>
        <th>No</th>
        <th>Name</th>
        <th>Price ($)</th>
        <th>Quantity</th>
        <th>Status</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="productTable"></tbody>
  </table>
</div>

<script>
let products = [];
let editIndex = null;

// Load from LocalStorage on page load
window.onload = function() {
  const stored = localStorage.getItem("products");
  if(stored) {
    products = JSON.parse(stored);
    renderTable();
  }
}

// Save to LocalStorage
function saveToLocalStorage() {
  localStorage.setItem("products", JSON.stringify(products));
}

// Add product
function addProduct() {
  const name = document.getElementById("productName").value.trim();
  const price = parseFloat(document.getElementById("price").value);
  const quantity = parseInt(document.getElementById("quantity").value);

  if(!name || isNaN(price) || isNaN(quantity)) {
    alert("Please enter valid Name, Price and Quantity");
    return;
  }

  if(editIndex !== null) {
    products[editIndex] = {name, price, quantity};
    editIndex = null;
  } else {
    products.push({name, price, quantity});
  }

  saveToLocalStorage();
  clearForm();
  renderTable();
}

// Render table
function renderTable() {
  const table = document.getElementById("productTable");
  table.innerHTML = "";

  products.forEach((p, i) => {
    const row = document.createElement("tr");
    if(p.quantity === 0) row.classList.add("table-danger");

    row.innerHTML = `
      <td>${i+1}</td>
      <td>${p.name}</td>
      <td>$${p.price.toFixed(2)}</td>
      <td>${p.quantity}</td>
      <td><span class="badge ${p.quantity>0?'bg-success':'bg-danger'}">${p.quantity>0?'In Stock':'Out of Stock'}</span></td>
      <td>
        <button class="btn btn-sm btn-warning me-1" onclick="editProduct(${i})">Edit</button>
        <button class="btn btn-sm btn-danger" onclick="deleteProduct(${i})">Delete</button>
      </td>
    `;
    table.appendChild(row);
  });
}

// Edit product
function editProduct(index) {
  const p = products[index];
  document.getElementById("productName").value = p.name;
  document.getElementById("price").value = p.price;
  document.getElementById("quantity").value = p.quantity;
  editIndex = index;
}

// Delete product
function deleteProduct(index) {
  if(confirm("Delete this product?")) {
    products.splice(index,1);
    saveToLocalStorage();
    renderTable();
  }
}

// Clear form
function clearForm() {
  document.getElementById("productName").value = "";
  document.getElementById("price").value = "";
  document.getElementById("quantity").value = "";
}
</script>

</body>
</html>